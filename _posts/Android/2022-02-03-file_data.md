---
title: "[Android] íŒŒì¼ ì…ì¶œë ¥"
excerpt: "ë‚´ë¶€/ì™¸ë¶€ ì €ì¥ì†Œ íŒŒì¼ ì…ì¶œë ¥ ë‹¤ë£¨ê¸°!"
categories:
  - Android
tag:
  - android 
  - kotlin

last_modified_at: 2022-02-03
toc: true
toc_sticky: true
search: true
---

## Intro

ğŸ™‹â€â™€ï¸ ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” **íŒŒì¼ ì…ì¶œë ¥**ì— ê´€í•´ ì‘ì„±í•´ë³´ê³ ì í•œë‹¤!

ì•ˆë“œë¡œì´ë“œ **ë°ì´í„° ì €ì¥ì†Œ**ëŠ” í¬ê²Œ 2ê°€ì§€ë¡œ ë‚˜ë‰œë‹¤.

### 1. ë‚´ë¶€ ì €ì¥ì†Œ: ì• í”Œë¦¬ì¼€ì´ì…˜ì„ í†µí•´ì„œë§Œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë‹¤.
  * ìš©ëŸ‰ì´ ì‘ë‹¤.

### 2. ì™¸ë¶€ ì €ì¥ì†Œ: ë‹¨ë§ê¸° ë‚´ë¶€ ê³ ìœ  ì˜ì—­ì´ ì¡´ì¬í•´ ëª¨ë“  ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•˜ë‹¤.
  * ìš©ëŸ‰ì´ í¬ë‹¤.
  * **scoped storage ì •ì±…**


----
ğŸ‘© ê·¸ë ‡ë‹¤ë©´ scoped storage ì •ì±…ì— ëŒ€í•´ì„œ ì¡°ê¸ˆ ë” ìì„¸íˆ ì‚´í´ë³´ì!

### ğŸ™‹â€â™€ï¸ scoped storage ì •ì±…
  1. **ì•± ë°ì´í„° í´ë”**
  * ì½ê³  ì“°ê¸° ê¶Œí•œ í•„ìš”í•˜ì§€ ì•Šë‹¤.
  * **í•´ë‹¹ appì—ì„œë§Œ** ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë‹¤.
  * app ì‚­ì œ ì‹œ, **í•¨ê»˜ ì‚­ì œ**ëœë‹¤.

  2. ë¯¸ë””ì–´ íŒŒì¼ë“¤: ì‚¬ì§„, ë™ì˜ìƒ, ìŒì› íŒŒì¼ ì €ì¥ì†Œ

  3. **ê³µìš© íŒŒì¼ë“¤**
  * **Downloads í´ë”**ì— ì €ì¥ëœë‹¤.
  * ëª¨ë“  appì—ì„œ ì ‘ê·¼ì´ ê°€ëŠ¥í•˜ë‹¤. (**íŒŒì¼ ê´€ë¦¬ì ì–´í”Œ**ì„ í†µí•´ ì‚¬ìš©ìê°€ ì„ íƒí•œ íŒŒì¼ì´ ëŒ€ìƒ!)

<br>

ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ë‚´ë¶€ ì €ì¥ì†Œ, ì•± ë°ì´í„° í´ë”, ê³µìš© íŒŒì¼ í´ë” ì„¸ê°€ì§€ë¥¼ ì‚´í´ë³¼ ê²ƒì´ë‹¤.

## ğŸ™‹â€â™€ï¸ë‚´ë¶€ ì €ì¥ì†Œ
* **openFileOutput, openFileInput**
  * in/output streamì„ ì–»ì–´ì™€ ì‚¬ìš©í•œë‹¤.

### 1. openFileOutputì„ í†µí•´ ë‚´ë¶€ ì €ì¥ì†Œì— ë°ì´í„° ì €ì¥!
```
  val fos = openFileOutput("data1.dat", Context.MODE_PRIVATE)
  val dos = DataOutputStream  

  dos.writeInt(10)
  dos.writeBoolean(true)
  dos.writeUTF("test1")

  dos.flush()
  dos.close() 
```
* MODE_PRIVATE: ë®ì–´ ì”Œìš°ê¸°
  * MODE_APPEND: ì´ì–´ì„œ ì“°ê¸°

<br>

### 2. openFileInputì„ í†µí•´ ë‚´ë¶€ ì €ì¥ì†Œ ë°ì´í„° ì½ê¸°!
```
  val fis = openFileInput("data1.dat")
  val dis = DataInputStream(fis)

  val data1 = dis.readInt()
  val data3 = dis.readBoolean()
  val data4 = dis.readUTF()

  dis.close()
```

<br>

## ğŸ™‹â€â™€ï¸ì™¸ë¶€ ì €ì¥ì†Œ: ì•± ë°ì´í„° í´ë”
  * **FileInputStrea, FileOutputStream** ì‚¬ìš©
    * **ì•± ë°ì´í„° í´ë” ê²½ë¡œ**ë¥¼ ì‚¬ìš©í•œë‹¤.

### 1. ì•± ë°ì´í„° í´ë” ê²½ë¡œ ê°€ì ¸ì˜¤ê¸°!
```
file_path = getExternalFilesDir(null).toString()
```

* **null**ì„ ì§€ì •í•  ê²½ìš°, **ì•± ë°ì´í„° í´ë” ê²½ë¡œ**ê°€ ë°˜í™˜ëœë‹¤.
* **'ENVIRONMENT.____'**ë¡œ íŠ¹ì • í´ë”ë¥¼ ì§€ì •í•  ê²½ìš°, í•´ë‹¹ í´ë”ì˜ ê²½ë¡œê°€ ë°˜í™˜ëœë‹¤.

<br>

### 2. ì•± ë°ì´í„° í´ë”ì— ë°ì´í„° ì €ì¥!

```
  val fos = FileOutputStream("$file_path/data2.dat")
  val dos = DataOutputStream(fos)

  dos.writeInt(20)
  dos.writeBoolean(false)
  dos.writeUTF("test2")

  dos.flush()
  dos.close()
```

<br>

### 3. ì•± ë°ì´í„° í´ë”ì—ì„œ ë°ì´í„° ì½ì–´ì˜¤ê¸°!
```
  val fis = FileInputStream("$file_path/data2.dat")
  val dis = DataInputStream(fis)

  val data1 = dis.readInt()
  val data3 = dis.readBoolean()
  val data4 = dis.readUTF()

  dis.close()
```

<br>

## ğŸ™‹â€â™€ï¸ì™¸ë¶€ ì €ì¥ì†Œ: ê³µìš© íŒŒì¼
* **íŒŒì¼ ê´€ë¦¬ ì•±ì˜ ì•¡í‹°ë¹„í‹°**ë¥¼ ì´ìš©í•œë‹¤.

### 1. íŒŒì¼ì„ ë§Œë“¤ì–´ ì‚¬ìš©í•˜ê¸° ìœ„í•´ íŒŒì¼ ê´€ë¦¬ ì•± ì•¡í‹°ë¹„í‹° ì‹¤í–‰!
```
  val fileIntent = Intent(Intent.ACTION_CREATE_DOCUMENT)

  fileIntent.addCategory(Intent.CATEGORY_OPENABLE)

  fileIntent.type = "*/*"

  startActivityForResult(fileIntent, 100)
```

* Intentë¡œ **íŒŒì¼ ê´€ë¦¬ ì•± ì•¡í‹°ë¹„í‹°**ë¥¼ ì‹¤í–‰í•œë‹¤.
  * **ACTION_CREATE_DOCUMENT**: íŒŒì¼ì„ ë§Œë“¤ì–´ ì‚¬ìš©í•˜ê¸° ìœ„í•œ ìš©ë„
  * **CATEGORY_OPENABLE**: íŒŒì¼ì„ ì—´ ìˆ˜ ìˆë„ë¡ ì§€ì •
  * ì—´ì–´ ë³¼ íƒ€ì… ì§€ì •
    * 'image/*': ëª¨ë“  ì´ë¯¸ì§€ íŒŒì¼

<br>

* Intent ì‹¤í–‰ ê²°ê³¼ë¡œ ì‚¬ìš©ìê°€ ì§€ì •í•œ íŒŒì¼ì— ëŒ€í•´ì„œ í•´ë‹¹ ì½”ë“œ ì‹¤í–‰! (ì“°ê¸° ì‹¤í–‰)

  ```
  override fun onActivityResult(requestCode: Int, resultCode: Int, data: Intent?) {
          super.onActivityResult(requestCode, resultCode, data)

          if(requestCode == 100) {
              if (resultCode == RESULT_OK) {
                  // í•µì‹¬!
                  // w: ì“°ê¸° ëª¨ë“œë¡œ ì‚¬ìš©
                  val des1 = contentResolver.openFileDescriptor(data?.data!!, "w")
                  
                  val fos = FileOutputStream(des1?.fileDescriptor)
                  val dos = DataOutputStream(fos)

                  dos.writeInt(300)
                  dos.writeBoolean(true)
                  dos.writeUTF("test3")

                  dos.flush()
                  dos.close()
              }
          }
  }
  ```

<br>

### ê³µìš© íŒŒì¼ì„ ì½ê¸° ìœ„í•´ íŒŒì¼ ê´€ë¦¬ ì•± ì•¡í‹°ë¹„í‹° ì‹¤í–‰!

```
  val fileIntent = Intent(Intent.ACTION_OPEN_DOCUMENT)

  fileIntent.type = "*/*"

  startActivityForResult(fileIntent, 200)
```

* **ACTION_OPEN_DOCUMENT**: ë°ì´í„°ë¥¼ ì½ì–´ ì˜¤ëŠ” ìš©ë„

<BR>

* Intent ì‹¤í–‰ ê²°ê³¼ë¡œ ì‚¬ìš©ìê°€ ì§€ì •í•œ íŒŒì¼ì— ëŒ€í•´ì„œ í•´ë‹¹ ì½”ë“œ ì‹¤í–‰! (ì½ê¸° ì‹¤í–‰)
  * ìœ„ **onActivityResult** ì½”ë“œì— ì´ì–´ì„œ ì‘ì„±!

```
  }else if(requestCode == 200){
      if(resultCode == RESULT_OK) {
        # í•µì‹¬!
        # r: ì½ê¸° ëª¨ë“œë¡œ ì‚¬ìš©
          val des2 = contentResolver.openFileDescriptor(data?.data!!, "r")
          val fis = FileInputStream(des2?.fileDescriptor)
          val dis = DataInputStream(fis)

          val data1 = dis.readInt()
          val data3 = dis.readBoolean()
          val data4 = dis.readUTF()

          dis.close()
      }
  }
```

## ğŸ“ƒì°¸ê³ 
* ì¸í”„ëŸ° ìœ¤ì¬ì„±ì˜ Kotlin ê¸°ë°˜ ì•ˆë“œë¡œì´ë“œ ì•± ê°œë°œ Part3 ìˆ˜ê°•